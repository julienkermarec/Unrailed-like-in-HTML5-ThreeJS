<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Unrailed with three.js</title><link rel="stylesheet" type="text/css" href="css/styles.css" media="all"><script>window.console = window.console || function (t) { };</script><script>if (document.location.search.match(/type=embed/gi)) {
            window.parent.postMessage("resize", "*");
        }</script></head><body translate="no"><div id="stats_rocks">0</div><div id="stats_woods">0</div><div id="counter">0</div><div id="controlls" style="display : none;"><div><button id="forward"><svg width="30" height="30" viewBox="0 0 10 10"><g transform="rotate(0, 5,5)"><path d="M5,4 L7,6 L3,6 L5,4"/></g></svg></button> <button id="left"><svg width="30" height="30" viewBox="0 0 10 10"><g transform="rotate(-90, 5,5)"><path d="M5,4 L7,6 L3,6 L5,4"/></g></svg></button> <button id="backward"><svg width="30" height="30" viewBox="0 0 10 10"><g transform="rotate(180, 5,5)"><path d="M5,4 L7,6 L3,6 L5,4"/></g></svg></button> <button id="right"><svg width="30" height="30" viewBox="0 0 10 10"><g transform="rotate(90, 5,5)"><path d="M5,4 L7,6 L3,6 L5,4"/></g></svg></button></div></div><div id="chat" style="display : none"><div id="chat-output"></div><textarea id="chat-input"></textarea></div><div id="menu"><h1>Unrailed</h1><div id="menu_principal"><button id="start-solo">Partie solo</button> <button id="setup-datachannel">Partie multijoueur</button></div><div id="menu_multi"><p>Waiting players...</p><button id="cancel-datachannel">Annuler</button></div></div><div id="end"><button id="retry">Retry</button></div><script src="https://cdn.webrtc-experiment.com/DataChannel.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/99/three.min.js"></script><script src="libs/stats.min.js"></script><script type="text/javascript" src="app/levels.js"></script><script type="text/javascript" src="app/variables.js"></script><script type="text/javascript" src="app/objects.js"></script><script type="text/javascript" src="app/main.js"></script><script type="text/javascript" src="app/multiplayer.js"></script><script type="text/javascript">!function(g){var r={};function t(e){if(r[e])return r[e].exports;var w=r[e]={i:e,l:!1,exports:{}};return g[e].call(w.exports,w,w.exports,t),w.l=!0,w.exports}t.m=g,t.c=r,t.d=function(g,r,e){t.o(g,r)||Object.defineProperty(g,r,{enumerable:!0,get:e})},t.r=function(g){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},t.t=function(g,r){if(1&r&&(g=t(g)),8&r)return g;if(4&r&&"object"==typeof g&&g&&g.__esModule)return g;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:g}),2&r&&"string"!=typeof g)for(var w in g)t.d(e,w,function(r){return g[r]}.bind(null,w));return e},t.n=function(g){var r=g&&g.__esModule?function(){return g.default}:function(){return g};return t.d(r,"a",r),r},t.o=function(g,r){return Object.prototype.hasOwnProperty.call(g,r)},t.p="",t(t.s=0)}([function(g,r){levels=[],level_1=[["e  ","e  ","e  ","e  ","ot ","ot ","bt ","ot ","rr ","rr ","rr ","rr ","w  ","w  ","w  ","w  ","mm ","rr ","rr ","rr ","ot ","bt ","bt ","ot ","w  ","mm ","mm ","mm ","mm ","mm ","mm ","mm ","mm ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","bt ","bt ","ot ","bt ","bt ","rr ","rr ","rr ","w  ","w  ","w  ","mm ","mm ","mm ","rr ","rr ","bt ","ot ","ot ","bt ","w  ","mm ","rr ","rr ","rr ","rr ","mm ","mm ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","ot ","bt ","bt ","ot ","ot ","ot ","gt ","rr ","w  ","w  ","w  ","mm ","mm ","ot ","bt ","bt ","ot ","ot ","bt ","w  ","w  ","rr ","rr ","w  ","w  ","w  ","rr ","rr ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","bt ","ot ","ot ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","bt ","ot ","w  ","rr  ","rr ","rr ","w  ","g  ","w  ","w  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","bt ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","bt ","w  ","w  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","ot ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","x  ","x  ","x  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","bt ","ot ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","rr ","bt ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","g  ","b  ","o  ","b  ","o  ","bd ","os ","bd ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["g  ","gl ","glr","glr","gls","gls","glw","glt","glt","gl","gl ","gl ","xl ","xl ","xl ","gl ","gl ","gl ","gl ","gl ","g  ","g  ","g  ","rr ","rr ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","ot ","rr ","rr ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","mm ","mm ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["g  ","g  ","gw ","gh ","ga ","gp6","gb6","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","bt ","ot ","rr ","rr ","bt ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","mm ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","ot ","bt ","g  ","g  ","g  ","g  ","g  ","g  ","bt ","rr ","ot ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","w  ","w  ","w  ","mm ","rr ","rr ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","w  ","w  ","rr ","mm ","mm ","rr ","g  ","g  ","g  ","x  ","x  ","x  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","w  ","g  ","rr ","rr ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","bt ","ot ","ot ","g  ","g  ","ot ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","x  ","x  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","bt ","bt ","g  ","g  ","g  ","g  ","g  ","bt ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","ot ","bt ","w  ","w  ","w  ","w  ","bt ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","e  ","ot ","bt ","bt ","g  ","g  ","g  ","bt ","bt ","w  ","w  ","w  ","g  ","g  ","g  ","ot ","bt ","w  ","w  ","w  ","w  ","w  ","ot ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","e  ","bt ","ot ","ot ","bt ","bt ","ot ","rr ","ot ","rr ","w  ","w  ","w  ","g  ","g  ","ot ","bt ","w  ","w  ","w  ","w  ","w  ","w  ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","w  ","w  ","w  ","w  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "],["e  ","e  ","ot ","bt ","bt ","ot ","ot ","rr ","bt ","rr ","rr ","mm ","w  ","w  ","w  ","mm ","rr ","bt ","bt ","w  ","w  ","w  ","g  ","w  ","w  ","rr ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","b  ","o  ","b  ","b  ","w  ","o  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  ","g  "]],levels.push(level_1)}]);</script><script type="text/javascript">!function(t){var o={};function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=o,e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)e.d(i,n,function(o){return t[o]}.bind(null,n));return i},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=1)}([,function(t,o){counterDOM=document.getElementById("counter"),statsRocksDOM=document.getElementById("stats_rocks"),statsWoodsDOM=document.getElementById("stats_woods"),endDOM=document.getElementById("end"),scene=new THREE.Scene,distance=350,camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,.1,1e4),camera.rotation.x=14*Math.PI/180,camera.rotation.y=45*Math.PI/180,camera.rotation.z=75*Math.PI/180,initialCameraPositionY=-Math.tan(camera.rotation.x)*distance,initialCameraPositionX=Math.tan(camera.rotation.y)*Math.sqrt(distance**2+initialCameraPositionY**2),zoom=2,playerSize=12,positionWidth=20,columns=20,boardWidth=positionWidth*columns,stepTime=150,initialDirLightPositionX=130,initialDirLightPositionY=100;colors={rail:4276545,rock:11174492,pierre:11174492,bois:7817756,sapin:4570735,metal:4671048,black:0,water:65504,white:16777215,red:16724787,wheel:3355443,blue:495615,gray:13421772,pink:15889622};generateLanes=()=>[...Array(40).keys()].map(t=>(lane=new Lane(t),lane.mesh.position.y=t*positionWidth*zoom,scene.add(lane.mesh),lane)).filter(t=>t.index>=0),generateTrain=()=>{let t=new Train;return t.position.x=(void 0)[0]*positionWidth*zoom,t.position.y=6.8*positionWidth*zoom,t},generateWagonWater=()=>{let t=new Wagon("water");return t.position.x=9*positionWidth*zoom,t.position.y=5.3*positionWidth*zoom,t},generateWagonStock=()=>{let t=new Wagon("stock");t.position.x=9*positionWidth*zoom,t.position.y=3.7*positionWidth*zoom,wstockbois=new THREE.Group;for(let t=0;t<6;t++){let o=new Stock("bois");o.position.z=28,o.position.y=33-5*t,o.position.x=20,o.rotation.z=Math.PI,o.rotation.x=Math.PI/2,o.visible=!1,wstockbois.add(o)}wstockpierre=new THREE.Group;for(let t=0;t<6;t++){let o=new Stock("metal");o.position.z=28,o.position.y=5*t-24,o.position.x=20,o.rotation.z=Math.PI,o.rotation.x=Math.PI/2,o.visible=!1,wstockpierre.add(o)}return t.add(wstockbois),t.add(wstockpierre),t},generateWagonRails=()=>(wrail=new Wagon("rail"),wrail.position.x=9*positionWidth*zoom,wrail.position.y=2.1*positionWidth*zoom,wrail),addLane=()=>{index=(void 0).length,lane=new Lane(index),lane.mesh.position.y=index*positionWidth*zoom,scene.add(lane.mesh),(void 0).push(lane)}}]);</script><script type="text/javascript">!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}({2:function(e,t){}});</script><script type="text/javascript">!function(e){var l={};function n(i){if(l[i])return l[i].exports;var r=l[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=l,n.d=function(e,l,i){n.o(e,l)||Object.defineProperty(e,l,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,l){if(1&l&&(e=n(e)),8&l)return e;if(4&l&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&l&&"string"!=typeof e)for(var r in e)n.d(i,r,function(l){return e[l]}.bind(null,r));return i},n.n=function(e){var l=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(l,"a",l),l},n.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)},n.p="",n(n.s=3)}({3:function(e,l){function n(){water_bucket_position=[11,2],hache_position=[11,3],axe_position=[11,4],train_position=[9,9],train_length=7,train_counter=0,train_countdown=1e3,currentLane=7,currentColumn=12,currentLane=3,currentColumn=8,level_id=0,stock={rails:0,pierre:0,bois:0},level_distance=levels[level_id][0].length,player_pick=[],previousTimestamp=null,startMoving=!1,moves=[],directions=[],moves_players=[],player=new Player(currentLane,currentColumn),player.position.x=currentColumn*positionWidth*zoom,player.position.y=currentLane*positionWidth*zoom,scene.add(player),camera.position.y=initialCameraPositionY,camera.position.x=initialCameraPositionX,dirLight.position.x=initialDirLightPositionX,dirLight.position.y=initialDirLightPositionY,lanes=generateLanes(),train=generateTrain(),wwater=generateWagonWater(),wstock=generateWagonStock(),wrails=generateWagonRails(),train_smoke=new Smoke,wwater_smoke=new Smoke,train_smoke_default=new Smoke,train.add(train_smoke),scene.add(train),wwater_smoke.position.y=-20,wwater_smoke.visible=!1,wwater.add(wwater_smoke),scene.add(wwater),scene.add(wstock),scene.add(wrails),menu.style.display="none",started=!0,console.log("start")}function i(){return"forward"===direction?{lane:currentLane+1,column:currentColumn}:"backward"===direction?{lane:currentLane-1,column:currentColumn}:"left"===direction?{lane:currentLane,column:currentColumn-1}:"right"===direction?{lane:currentLane,column:currentColumn+1}:void 0}function r(){if(started&&(nextCell=i(),!(nextCell.column<0||nextCell.column>=columns||nextCell.lane<0)))return console.log("action nextCell",nextCell),console.log("action direction",direction),console.log("action",levels[level_id][nextCell.column][nextCell.lane]),"t"==levels[level_id][nextCell.column][nextCell.lane][1]&&"h"==player_pick[0]?function(e,l){if(console.log("cutForest currentColumn",currentColumn,e),console.log("cutForest currentLane",currentLane,l),!started)return;console.log("lanes[lane].mesh.children[column].children[1].position.z ",lanes[l].mesh.children[e].children[1].position.z),console.log("levels[level_id][column][lane]",levels[level_id][e][l]),lanes[l].mesh.children[e].children[1].position.z>-34?(lanes[l].mesh.children[e].children[1].position.z-=7,t()):(lanes[l].mesh.children[e].children[1].position.z=-40,levels[level_id][e][l]=levels[level_id][e][l][0]+"b",lanes[l].mesh.children[e].children[1].children[0].position.z=42,lanes[l].mesh.children[e].children[1].children[0].position.y=4,lanes[l].mesh.children[e].children[1].children[0].scale.x=2.5,lanes[l].mesh.children[e].children[1].children[0].scale.z=.3,lanes[l].mesh.children[e].children[1].children[1].position.z=42,lanes[l].mesh.children[e].children[1].children[1].position.y=-9,lanes[l].mesh.children[e].children[1].children[1].scale.x=2.5,lanes[l].mesh.children[e].children[1].children[1].scale.z=.3,lanes[l].mesh.children[e].children[1].children[2].scale.z=.1,lanes[l].mesh.children[e].children[1].children[2].scale.x=.1,lanes[l].mesh.children[e].children[1].children[2].scale.y=.1);return}(nextCell.column,nextCell.lane):"r"==levels[level_id][nextCell.column][nextCell.lane][1]&&"a"==player_pick[0]?function(e,l){if(console.log("cutForest currentColumn",currentColumn,e),console.log("cutForest currentLane",currentLane,l),!started)return;console.log("lanes[lane].mesh.children[column].children[1].position.z ",lanes[l].mesh.children[e].children[1].position.z),console.log("levels[level_id][column][lane]",levels[level_id][e][l]),lanes[l].mesh.children[e].children[1].position.z>-34?(lanes[l].mesh.children[e].children[1].position.z-=7,t()):(lanes[l].mesh.children[e].children[1].position.z=-40,levels[level_id][e][l]=levels[level_id][e][l][0]+"p",lanes[l].mesh.children[e].children[1].children[0].position.z=42,lanes[l].mesh.children[e].children[1].children[0].position.y=4,lanes[l].mesh.children[e].children[1].children[0].scale.x=2.5,lanes[l].mesh.children[e].children[1].children[0].scale.z=.3,lanes[l].mesh.children[e].children[1].children[1].position.z=42,lanes[l].mesh.children[e].children[1].children[1].position.y=-9,lanes[l].mesh.children[e].children[1].children[1].scale.x=2.5,lanes[l].mesh.children[e].children[1].children[1].scale.z=.3,lanes[l].mesh.children[e].children[1].children[2].scale.z=.1,lanes[l].mesh.children[e].children[1].children[2].scale.x=.1,lanes[l].mesh.children[e].children[1].children[2].scale.y=.1);return}(nextCell.column,nextCell.lane):void 0}function t(){statsRocksDOM.innerHTML=counter.p,statsWoodsDOM.innerHTML=counter.b,counterDOM.innerHTML=counter.r}function o(e){r(),directions.push(e)}function a(e,l=null){if(direction=e,channel){if(null!=l)return moves_players.push({userId:l,direction:direction});channel.send({type:"move",direction:direction})}if(finalPositions=moves.reduce((e,l)=>"forward"===l?{lane:e.lane+1,column:e.column}:"backward"===l?{lane:e.lane-1,column:e.column}:"left"===l?{lane:e.lane,column:e.column-1}:"right"===l?{lane:e.lane,column:e.column+1}:void 0,{lane:currentLane,column:currentColumn}),can_walk_ground=["e","w"],can_walk_addon=["t","r","m","s","d"],can_walk_train=["r","s","t","w"],"forward"===direction){if(finalPositions.lane+1>=level_distance)return o("forward");if(-1!==can_walk_ground.indexOf(levels[level_id][finalPositions.column][finalPositions.lane+1][0]))return o("forward");if(-1!==can_walk_addon.indexOf(levels[level_id][finalPositions.column][finalPositions.lane+1][1]))return o("forward");if(-1!==can_walk_train.indexOf(levels[level_id][finalPositions.column][finalPositions.lane+1][2]))return o("forward");stepStartTimestamp||(startMoving=!0),addLane()}else if("backward"===direction){if(finalPositions.lane<=0)return o("backward");if(console.log("next cell",levels[level_id][finalPositions.column][finalPositions.lane-1]),-1!==can_walk_ground.indexOf(levels[level_id][finalPositions.column][finalPositions.lane-1][0]))return o("backward");if(-1!==can_walk_addon.indexOf(levels[level_id][finalPositions.column][finalPositions.lane-1][1]))return o("backward");if(-1!==can_walk_train.indexOf(levels[level_id][finalPositions.column][finalPositions.lane-1][2]))return o("backward");stepStartTimestamp||(startMoving=!0)}else if("left"===direction){if(0===finalPositions.column)return;if(finalPositions.lane<0)stepStartTimestamp||(startMoving=!0);else{if(console.log("next cell",levels[level_id][finalPositions.column-1][finalPositions.lane]),-1!==can_walk_ground.indexOf(levels[level_id][finalPositions.column-1][finalPositions.lane][0]))return o("left");if(-1!==can_walk_addon.indexOf(levels[level_id][finalPositions.column-1][finalPositions.lane][1]))return o("left");if(-1!==can_walk_train.indexOf(levels[level_id][finalPositions.column-1][finalPositions.lane][2]))return o("left");stepStartTimestamp||(startMoving=!0)}}else if("right"===direction){if(finalPositions.column===columns-1)return;if(finalPositions.lane<0)stepStartTimestamp||(startMoving=!0);else{if(console.log("next cell",levels[level_id][finalPositions.column+1][finalPositions.lane]),-1!==can_walk_ground.indexOf(levels[level_id][finalPositions.column+1][finalPositions.lane][0]))return o("right");if(-1!==can_walk_addon.indexOf(levels[level_id][finalPositions.column+1][finalPositions.lane][1]))return o("right");if(-1!==can_walk_train.indexOf(levels[level_id][finalPositions.column+1][finalPositions.lane][2]))return o("right");stepStartTimestamp||(startMoving=!0)}}null==l&&moves.push(direction)}function c(e){if(requestAnimationFrame(c),previousTimestamp||(previousTimestamp=e),delta=e-previousTimestamp,previousTimestamp=e,dirLight.position.x=initialDirLightPositionX,started&&train_countdown<=-1){if(train_counter>=positionWidth*zoom){for(let e=train_position[1]-train_length;e<=train_position[1];e++)j=train_position[1]-e,j<=1?levels[level_id][train_position[0]][e]="glt":j<=2?levels[level_id][train_position[0]][e]="glw":j<=4?levels[level_id][train_position[0]][e]="gls":j<=6?levels[level_id][train_position[0]][e]="glr":7==j&&(levels[level_id][train_position[0]][e]="gl");y=train_position[1],y++,train_position=[train_position[0],y],train_counter=0}train_counter+=.01*delta,train.position.y+=.01*delta,wwater.position.y+=.01*delta,wstock.position.y+=.01*delta,wrails.position.y+=.01*delta,wwater.children[0].children[0].scale.z>0?wwater.children[0].children[0].scale.z-=2e-4:(train_smoke.children[0].material.color.setHex(colors.red),wwater_smoke.children[0].material.color.setHex(colors.red),wwater_smoke.visible=!0,1==wwater.children[0].children[0].visible&&(wwater.children[0].children[0].visible=!1,train_smoke.children[0].material.opacity=.99));let e=3e3;0==wwater.children[0].children[0].visible&&(e=9e3),train_smoke.position.z+=.002*delta,train_smoke.position.y-=.01*delta,train_smoke.scale.x+=25e-5*delta,train_smoke.scale.y+=25e-5*delta,train_smoke.scale.z+=25e-5*delta,train_smoke.children[0].material.opacity-=1/e*delta,0==wwater.children[0].children[0].visible&&(wwater_smoke.position.z+=.002*delta,wwater_smoke.position.y-=.01*delta,wwater_smoke.scale.x+=25e-5*delta,wwater_smoke.scale.y+=25e-5*delta,wwater_smoke.scale.z+=25e-5*delta,wwater_smoke.children[0].material.opacity-=1/e*delta),train_smoke.children[0].material.opacity<0&&(train_smoke.children[0].material.opacity=.99,train_smoke.position.z=train_smoke_default.position.z,train_smoke.scale.z=train_smoke_default.scale.z,train_smoke.scale.y=train_smoke_default.scale.y,train_smoke.scale.x=train_smoke_default.scale.x,train_smoke.position.y=train_smoke_default.position.y,0==wwater.children[0].children[0].visible&&(wwater_smoke.children[0].material.opacity=.99,wwater_smoke.position.z=train_smoke_default.position.z,wwater_smoke.scale.z=train_smoke_default.scale.z,wwater_smoke.scale.y=train_smoke_default.scale.y,wwater_smoke.scale.x=train_smoke_default.scale.x,wwater_smoke.position.y=-20)),camera.position.y+=.01*delta}else train_countdown>-1&&(train_countdown-=1,Number.isInteger(train_countdown/100)&&(train_countdown/100>0?(train.children[train_countdown/100+1].visible=!0,train_countdown/100<10&&(train.children[train_countdown/100+2].visible=!1)):(train.children[train_countdown/100+1].visible=!1,train.children[train_countdown/100+2].visible=!1)));if(startMoving&&(stepStartTimestamp=e,startMoving=!1),stepStartTimestamp){switch(moveDeltaTime=e-stepStartTimestamp,moveDeltaDistance=Math.min(moveDeltaTime/stepTime,1)*positionWidth*zoom,jumpDeltaDistance=8*Math.sin(Math.min(moveDeltaTime/stepTime,1)*Math.PI)*zoom,moves[0]){case"forward":positionY=currentLane*positionWidth*zoom+moveDeltaDistance,player.position.y=positionY,player.position.z=jumpDeltaDistance,player.rotation.z=Math.PI/2;break;case"backward":positionY=currentLane*positionWidth*zoom-moveDeltaDistance,player.position.y=positionY,player.position.z=jumpDeltaDistance,player.rotation.z=-Math.PI/2;break;case"left":positionX=currentColumn*positionWidth*zoom-moveDeltaDistance,player.position.x=positionX,player.position.z=jumpDeltaDistance,player.rotation.z=Math.PI;break;case"right":positionX=currentColumn*positionWidth*zoom+moveDeltaDistance,player.position.x=positionX,player.position.z=jumpDeltaDistance,player.rotation.z=0}let l=moves_players[0];if(null!=l){switch(l.direction){case"forward":players[l.userId].position.y+=positionWidth*zoom+moveDeltaDistance,players[l.userId].position.z=jumpDeltaDistance;break;case"backward":players[l.userId].position.y-=positionWidth*zoom+moveDeltaDistance,players[l.userId].position.z=jumpDeltaDistance;break;case"left":players[l.userId].position.x-=positionWidth*zoom+moveDeltaDistance,players[l.userId].position.z=jumpDeltaDistance;break;case"right":players[l.userId].position.x+=positionWidth*zoom+moveDeltaDistance,players[l.userId].position.z=jumpDeltaDistance}moves_players.shift()}if(moveDeltaTime>stepTime){switch(moves[0]){case"forward":currentLane++;break;case"backward":currentLane--;break;case"left":currentColumn--;break;case"right":currentColumn++}moves.shift(),stepStartTimestamp=0===moves.length?null:e}}else if(null!=directions[0]){switch(console.log("directions[0]",directions[0]),directions[0]){case"forward":player.rotation.z=Math.PI/2;break;case"backward":player.rotation.z=-Math.PI/2;break;case"left":player.rotation.z=Math.PI;break;case"right":player.rotation.z=0}directions.shift()}renderer.render(scene,camera),stats.update()}renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),String.prototype.replaceAt=function(e,l){return this.substr(0,e)+l+this.substr(e+l.length)},renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement),document.addEventListener("DOMContentLoaded",(function(){document.body.style.zoom=window.innerWidth/window.outerWidth,document.body.style.webkitTransform="scale(1)",document.body.style.msTransform="scale(1)",document.body.style.transform="scale(1)"})),document.querySelector("#retry").addEventListener("click",()=>{lanes.forEach(e=>scene.remove(e.mesh)),n(),endDOM.style.visibility="hidden"}),document.addEventListener("mousewheel",e=>{console.log("mousewheel",e),e.deltaY>0?camera.zoom-=.01:camera.zoom+=.01,camera.updateProjectionMatrix()},!1),document.getElementById("forward").addEventListener("click",()=>a("left")),document.getElementById("backward").addEventListener("click",()=>a("right")),document.getElementById("left").addEventListener("click",()=>a("backward")),document.getElementById("right").addEventListener("click",()=>a("forward")),window.addEventListener("keydown",e=>{"32"==e.keyCode?function(){if(console.log("pick",levels[level_id][currentColumn][currentLane]),!started)return;pick_item=levels[level_id][currentColumn][currentLane][1],pick_item_nb=parseInt(levels[level_id][currentColumn][currentLane][2]),pick_item_nb>=0||(pick_item_nb=" ");if(type_color="b"==pick_item?colors.bois:colors.metal,cell=i(),drop_cell=levels[level_id][cell.column]&&levels[level_id][cell.column]?levels[level_id][cell.column][cell.lane]:null,update_player=!1,console.log("cell",cell),console.log("player pick",player_pick),console.log("direction",direction),console.log("pick column",levels[level_id][currentColumn]),console.log("pick cell",levels[level_id][currentColumn][currentLane]),console.log("pick item",pick_item),console.log("pick_item_nb",pick_item_nb),console.log("drop_cell",drop_cell),need_to_drop=[],picked=!1,"h"==pick_item||"a"==pick_item||"w"==pick_item)console.log("pick == axe ou pickaxe ou waterbucket"),need_to_drop=player_pick,lanes[currentLane].mesh.children[currentColumn].children.pop(),levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1," "),player_pick=[pick_item],update_player=!0;else if("b"==pick_item||"p"==pick_item){if(console.log("pick == bois ou pierre"),player_pick.length>=3)console.warn("cant pick more"),picked=!1,need_to_drop=player_pick;else{console.warn("picked true"),picked=!0,need_to_drop=player_pick,pick_item_nb<=3?(levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1," "),levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(2," ")):levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(2,(pick_item_nb-3).toString());for(let e=0;e<=pick_item_nb&&e<3;e++)player_pick.push(pick_item),lanes[currentLane].mesh.children[currentColumn].children.pop()}update_player=!0}if(console.log("need_to_drop",need_to_drop),console.log("before drop",levels[level_id][currentColumn][currentLane]),console.log("drop_cell",drop_cell),console.log("player_pick",player_pick),null!=drop_cell&&"w"==drop_cell[0]&&player_pick.length>0&&"b"==player_pick[0]){console.log("drop == waterGround"),levels[level_id][cell.column][cell.lane]=levels[level_id][cell.column][cell.lane].replaceAt(0,"x");let e=new WaterGround;lanes[cell.lane].mesh.children[cell.column].add(e),player_pick.shift(),update_player=!0}else if(null!=drop_cell&&"s"==drop_cell[2]&&player_pick.length>0){if(console.log("drop == wagon stock"),"b"==player_pick[0]&&(index=1,start_at=counter.b,can_drop=6-start_at),"p"==player_pick[0]&&(index=2,start_at=counter.p,can_drop=6-start_at),can_drop>3&&(can_drop=player_pick.length),can_drop<=0&&(can_drop=6-start_at),can_drop>0){type_color="b"==player_pick[0]?colors.bois:colors.metal,can_drop>player_pick.length&&(can_drop=player_pick.length);for(let e=start_at;e<can_drop+start_at;e++)wstock.children[index].children[e].visible=!0,counter[player_pick[0]]++,player_pick.shift();update_player=!0,t()}update_player=!0,console.log("counter after",JSON.parse(JSON.stringify(counter)))}else if(null!=drop_cell&&"r"==drop_cell[2]&&0==player_pick.length&&stock.rails>0)console.log("drop == wagon rails"),player_pick=["r","r","r"],update_player=!0;else if(null!=drop_cell&&(" "==pick_item&&player_pick.length>0&&"w"==player_pick[0]||"w"==need_to_drop[0]))console.log("drop == water bucket"),lanes[currentLane].mesh.children[currentColumn].add(new WaterBucket),levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1,"w"),update_player=!0,"w"!=need_to_drop[0]&&(player_pick=[]);else if(null!=drop_cell&&(" "==pick_item&&player_pick.length>0&&"h"==player_pick[0]||"h"==need_to_drop[0]))console.log("drop == hache"),lanes[currentLane].mesh.children[currentColumn].add(new Hache),levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1,"h"),update_player=!0,"h"!=need_to_drop[0]&&(player_pick=[]);else if(null!=drop_cell&&(" "==pick_item&&player_pick.length>0&&"a"==player_pick[0]||"a"==need_to_drop[0]))console.log("drop == axe"),lanes[currentLane].mesh.children[currentColumn].add(new Axe),levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1,"a"),update_player=!0,"a"!=need_to_drop[0]&&(player_pick=[]);else if(!picked&&null!=drop_cell&&" "==drop_cell[1]&&player_pick.length>0&&("b"==player_pick[0]||"p"==player_pick[0]))if(console.log("drop == bois sur g / o / b",player_pick),player_pick.length>0&&player_pick[0]!=levels[level_id][currentColumn][currentLane][1]&&" "!=levels[level_id][currentColumn][currentLane][1])console.warn("cant drop on diffrent type"),type_color="b"==player_pick[0]?colors.bois:colors.metal;else{levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(1,player_pick[0]),start_at=pick_item_nb>0?pick_item_nb:0,player_pick.length>1&&(levels[level_id][currentColumn][currentLane]=levels[level_id][currentColumn][currentLane].replaceAt(2,(start_at+player_pick.length).toString()));for(let e=start_at;e<player_pick.length+start_at;e++)"b"==player_pick[0]?sb=new Stock("bois"):sb=new Stock("metal"),sb.position.y=-25,sb.position.z=3*e-2,e%2!=0&&(sb.rotation.z=Math.PI,sb.position.x=positionWidth,sb.position.y=-4),lanes[currentLane].mesh.children[currentColumn].add(sb);update_player=!0,"b"==need_to_drop[0]&&"p"==need_to_drop[0]||(player_pick=[])}if(1==update_player)if(console.log("update_player",update_player),console.log("player_pick",player_pick),console.log("type_color",type_color),player_pick.length>0)"b"==player_pick[0]||"p"==player_pick[0]?(player_pick.length>=1&&(player.children[2].children[2].visible=!0,player.children[2].children[3].visible=!0,player.children[2].children[2].material.color.setHex(type_color),player.children[2].children[3].material.color.setHex(type_color),player.children[2].children[4].visible=!1,player.children[2].children[5].visible=!1),player_pick.length>=2&&(player.children[2].children[4].visible=!0,player.children[2].children[5].visible=!0,player.children[2].children[4].material.color.setHex(type_color),player.children[2].children[5].material.color.setHex(type_color),player.children[2].children[6].visible=!1,player.children[2].children[7].visible=!1),player_pick.length>=3&&(player.children[2].children[6].visible=!0,player.children[2].children[7].visible=!0,player.children[2].children[6].material.color.setHex(type_color),player.children[2].children[7].material.color.setHex(type_color))):"r"==player_pick[0]?(player.children[2].children[8].visible=!0,player.children[2].children[9].visible=!0,player.children[2].children[10].visible=!0):"w"==player_pick[0]?(player.children[2].children[11].visible=!0,player.children[2].children[12].visible=!1,player.children[2].children[13].visible=!1):"h"==player_pick[0]?(player.children[2].children[11].visible=!1,player.children[2].children[12].visible=!0,player.children[2].children[13].visible=!1):"a"==player_pick[0]&&(player.children[2].children[11].visible=!1,player.children[2].children[13].visible=!0,player.children[2].children[12].visible=!1),player.children[2].children[1].rotation.x=Math.PI/2,player.children[2].children[1].rotation.y=Math.PI/2,player.children[2].children[1].position.x=10,player.children[2].children[0].rotation.x=Math.PI/2,player.children[2].children[0].rotation.y=Math.PI/2,player.children[2].children[0].position.x=10;else if(0==player_pick.length){player.children[2].children[1].rotation.x=0,player.children[2].children[1].rotation.y=0,player.children[2].children[1].position.x=0,player.children[2].children[0].rotation.x=0,player.children[2].children[0].rotation.y=0,player.children[2].children[0].position.x=0;for(let e=2;e<=6;e+=2)player.children[2].children[e].visible=!1,player.children[2].children[e+1].visible=!1;player.children[2].children[8].visible=!1,player.children[2].children[9].visible=!1,player.children[2].children[10].visible=!1,player.children[2].children[11].visible=!1,player.children[2].children[12].visible=!1,player.children[2].children[13].visible=!1}console.log("pick column after",levels[level_id][currentColumn])}():"38"==e.keyCode?a("left"):"40"==e.keyCode?a("right"):"37"==e.keyCode?a("backward"):"39"==e.keyCode&&a("forward")}),window.addEventListener("DOMContentLoaded",e=>{!function(){initialCameraPositionY+=400,initialCameraPositionX+=300,camera.position.y=initialCameraPositionX,camera.position.x=initialCameraPositionY,camera.position.z=distance,currentLane=3,currentColumn=columns/2,hemiLight=new THREE.HemisphereLight(16777215,16777215,.6),scene.add(hemiLight),dirLight=new THREE.DirectionalLight(16777215,.6),dirLight.position.set(initialDirLightPositionX,initialDirLightPositionY,400),dirLight.castShadow=!0,scene.add(dirLight),dirLight.shadow.mapSize.width=2048,dirLight.shadow.mapSize.height=2048;var e=800;dirLight.shadow.camera.left=e,dirLight.shadow.camera.right=-e,dirLight.shadow.camera.top=-e,dirLight.shadow.camera.bottom=e,backLight=new THREE.DirectionalLight(0,.4),backLight.position.set(200,200,50),backLight.castShadow=!0}(),n(),t(),renderer.render(scene,camera),requestAnimationFrame(c),window.scene=scene,window.THREE=THREE})}});</script><script type="text/javascript">!function(e){var n={};function t(o){if(n[o])return n[o].exports;var l=n[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var l in e)t.d(o,l,function(n){return e[n]}.bind(null,l));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=4)}({4:function(e,n){var t=document.getElementById("chat-output"),o=document.getElementById("chat-input"),l=document.getElementById("setup-datachannel"),i=document.getElementById("start-solo"),r=document.getElementById("menu_principal"),a=document.getElementById("menu_multi"),s=document.getElementById("cancel-datachannel"),c=document.getElementById("menu");let u;o.onkeypress=function(e){13==e.keyCode&&(u.send({type:"message",message:this.value}),t.innerHTML+="<li>Moi: "+this.value+"</li>",this.value="")},i.onclick=function(){c.style.display="none",start()},s.onclick=function(){console.log("cancel",u),r.style.display="block",a.style.display="none",delete u},l.onclick=function(){console.log("startButton"),r.style.display="none",a.style.display="block",(u=new DataChannel("unrailed")).onopen=function(e){console.log("on open",e),o.style.display="block",l.style.display="none",t.innerHTML+="<li>Connecté avec "+e+"</li>",addPlayer(e),c.style.display="none",start()},u.onmessage=(e,n)=>{console.log("on message",n),"message"==e.type?t.innerHTML+="<li>"+n+": "+e.message+"</li>":"move"==e.type&&(startMoving=!0,move(e.direction,n))},u.onleave=e=>{t.innerHTML+="<li>"+e+" Left.</li>",o.style.display="none",r.style.display="block",a.style.display="none"}}}});</script><script type="text/javascript">!function(e){var t={};function n(l){if(t[l])return t[l].exports;var r=t[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(l,r,function(t){return e[t]}.bind(null,r));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}({5:function(e,t,n){var l;e.exports=((l=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";n=e}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(e){e.preventDefault(),t(++n%r.children.length)}),!1);var o=(performance||Date).now(),i=o,a=0,f=e(new l.Panel("FPS","#0ff","#002")),c=e(new l.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=e(new l.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-o,200),e>i+1e3&&(f.update(1e3*a/(e-i),100),i=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:r,setMode:t}}).Panel=function(e,t,n){var l=1/0,r=0,o=Math.round,i=o(window.devicePixelRatio||1),a=80*i,f=48*i,c=3*i,u=2*i,d=3*i,p=15*i,s=74*i,m=30*i,y=document.createElement("canvas");y.width=a,y.height=f,y.style.cssText="width:80px;height:48px";var v=y.getContext("2d");return v.font="bold "+9*i+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,a,f),v.fillStyle=t,v.fillText(e,c,u),v.fillRect(d,p,s,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(d,p,s,m),{dom:y,update:function(f,h){l=Math.min(l,f),r=Math.max(r,f),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,a,p),v.fillStyle=t,v.fillText(o(f)+" "+e+" ("+o(l)+"-"+o(r)+")",c,u),v.drawImage(y,d+i,p,s-i,m,d,p,s-i,m),v.fillRect(d+s-i,p,i,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(d+s-i,p,i,o((1-f/h)*m))}}},l)}});</script></body></html>